<link rel="stylesheet" href="/css/styles.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<link href="https://unicons.iconscout.com/release/v4.0.8/css/line.css" rel="stylesheet">
<style>
  .users-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    margin-top: 2rem;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #eee;
  }
  th {
    background: #f8f9fa;
    font-weight: 600;
  }
  .role-badge {
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
  }
  .role-admin {
    background: #e74c3c;
    color: white;
  }
  .role-author {
    background: #3498db;
    color: white;
  }
  .role-user {
    background: #95a5a6;
    color: white;
  }
  select {
    padding: 0.4rem;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  .btn-delete {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 0.4rem 0.8rem;
    border-radius: 4px;
    cursor: pointer;
  }
</style>

<header>
  <div class="container">
    <div class="logo">
      <a href="/"><span><img src="data:image/png;base64,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" alt=""></span></a>
    </div>
    
    <nav>
      <ul class="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href="/admin">Dashboard</a></li>
        <li><a href="/admin/users">Users</a></li>
        <li><a href="/admin/blogs">Blogs</a></li>
        <li><a href="/logout">Logout</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="content-wrapper">
  <aside class="sidebar position-fixed top-0 left-0 overflow-auto h-100 float-left">
    <div class="sidebar-header d-flex justify-content-center align-items-center px-3 py-4">
      <div class="ms-2">
        <h5 class="fs-6 mb-0">
          <a class="text-decoration-none" href="#"><%= session.user.name %></a>
        </h5>
        <p class="mt-1 mb-0">Administrator</p>
      </div>
    </div>
    <hr>
    <br>
    <ul class="categories list-unstyled">
      <li>
       <a href="/admin"><i class="uil-estate fa-fw"></i> Dashboard</a>
      </li>
      <li>
        <a href="/admin/users" class="active"><i class="uil-users-alt"></i> Manage Users</a>
      </li>
      <li>
        <a href="/admin/blogs"><i class="uil-book"></i> Manage Blogs</a>
      </li>
      <li>
        <a href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
      </li>
    </ul>
  </aside>

  <div class="main-content">
    <div class="welcome">
      <h1>User Management</h1>
      <p>Manage all registered users and their roles</p>
    </div>

    <div class="users-table">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Joined</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(user => { %>
            <tr>
              <td><%= user.id %></td>
              <td><%= user.name %></td>
              <td><%= user.email %></td>
              <td>
                <% if (user.id == session.user.id) { %>
                  <span class="role-badge role-<%= user.role %>"><%= user.role %></span>
                <% } else { %>
                  <form method="POST" action="/admin/users/<%= user.id %>/role" style="display: inline;">
                    <select name="role" onchange="this.form.submit()">
                      <option value="user" <%= user.role === 'user' ? 'selected' : '' %>>User</option>
                      <option value="author" <%= user.role === 'author' ? 'selected' : '' %>>Author</option>
                      <option value="admin" <%= user.role === 'admin' ? 'selected' : '' %>>Admin</option>
                    </select>
                  </form>
                <% } %>
              </td>
              <td><%= new Date(user.created_at).toLocaleDateString() %></td>
              <td>
                <% if (user.id != session.user.id) { %>
                  <form method="POST" action="/admin/users/<%= user.id %>/delete" style="display: inline;" onsubmit="return confirm('Delete this user?')">
                    <button type="submit" class="btn-delete">Delete</button>
                  </form>
                <% } else { %>
                  <span style="color: #7f8c8d;">You</span>
                <% } %>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script src="/js/header.js"></script>