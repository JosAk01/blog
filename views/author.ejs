<link rel="stylesheet" href="/css/styles.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<link href="https://unicons.iconscout.com/release/v4.0.8/css/line.css" rel="stylesheet">
<style>
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }
  .stat-card {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .stat-card h3 {
    color: #7f8c8d;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }
  .stat-card .number {
    font-size: 2rem;
    font-weight: bold;
    color: #2c3e50;
  }
  .create-btn {
    display: inline-block;
    padding: 0.8rem 1.5rem;
    background: #27ae60;
    color: white;
    text-decoration: none;
    border-radius: 5px;
    margin-bottom: 1.5rem;
  }
  .create-btn:hover {
    background: #229954;
  }
  .blogs-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #eee;
  }
  th {
    background: #f8f9fa;
    font-weight: 600;
  }
  .status-badge {
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
  }
  .status-published {
    background: #d4edda;
    color: #155724;
  }
  .status-draft {
    background: #fff3cd;
    color: #856404;
  }
  .action-btns {
    display: flex;
    gap: 0.5rem;
  }
  .btn-sm {
    padding: 0.4rem 0.8rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85rem;
    text-decoration: none;
    display: inline-block;
  }
  .btn-view {
    background: #3498db;
    color: white;
  }
  .btn-edit {
    background: #f39c12;
    color: white;
  }
  .btn-delete {
    background: #e74c3c;
    color: white;
  }

  
  .blog-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    background: #ffffff;
    border-bottom: 1px solid #e9eaf3;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  }

  .blog-header .header-container {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    gap: 20px;
  }

  .blog-brand {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
    transition: transform 0.2s;
  }

  .blog-brand:hover {
    transform: translateY(-2px);
  }

  .blog-logo {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: linear-gradient(135deg, #5a5df5, #9a6bff);
    display: grid;
    place-items: center;
    color: white;
    font-weight: 800;
    font-size: 20px;
    box-shadow: 0 4px 12px rgba(90, 93, 245, 0.3);
  }

  .blog-brand-text {
    font-size: 20px;
    font-weight: 800;
    letter-spacing: 0.02em;
    background: linear-gradient(135deg, #5a5df5, #9a6bff);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  .blog-nav {
    display: flex;
    align-items: center;
    gap: 32px;
    flex: 1;
    justify-content: center;
  }

  .blog-nav a {
    text-decoration: none;
    color: #5c6074;
    font-weight: 600;
    font-size: 15px;
    padding: 8px 16px;
    border-radius: 8px;
    transition: all 0.3s;
    position: relative;
  }

  .blog-nav a:hover {
    color: #5a5df5;
    background: #eef0ff;
  }

  .blog-nav a.active {
    color: #5a5df5;
    background: #eef0ff;
  }

  .blog-nav a.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 16px;
    right: 16px;
    height: 2px;
    background: linear-gradient(90deg, #5a5df5, #9a6bff);
    border-radius: 2px;
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .user-menu {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 16px;
    background: #f7f7fb;
    border-radius: 12px;
    border: 1px solid #e9eaf3;
  }

  .user-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(135deg, #5a5df5, #9a6bff);
    display: grid;
    place-items: center;
    color: white;
    font-weight: 700;
    font-size: 14px;
  }

  .user-name {
    font-weight: 600;
    color: #0b1020;
    font-size: 14px;
  }

  .header-btn {
    padding: 10px 20px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 14px;
    text-decoration: none;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
  }

  .btn-login {
    background: transparent;
    color: #5a5df5;
    border: 1px solid #e9eaf3;
  }

  .btn-login:hover {
    background: #eef0ff;
    border-color: #5a5df5;
  }

  .btn-signup {
    background: linear-gradient(135deg, #5a5df5, #9a6bff);
    color: white;
    box-shadow: 0 4px 12px rgba(90, 93, 245, 0.3);
  }

  .btn-signup:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(90, 93, 245, 0.4);
  }

  .btn-logout {
    background: #f7f7fb;
    color: #5c6074;
    border: 1px solid #e9eaf3;
  }

  .btn-logout:hover {
    background: #ffe1e1;
    color: #e74c3c;
    border-color: #e74c3c;
  }

  .mobile-menu-btn {
    display: none;
    width: 40px;
    height: 40px;
    border: 1px solid #e9eaf3;
    background: transparent;
    border-radius: 10px;
    cursor: pointer;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 5px;
  }

  .mobile-menu-btn span {
    display: block;
    width: 20px;
    height: 2px;
    background: #0b1020;
    border-radius: 2px;
    transition: all 0.3s;
  }

  .mobile-menu-btn.active span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }

  .mobile-menu-btn.active span:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-btn.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -6px);
  }

  /* Responsive */
  @media (max-width: 968px) {
    .blog-nav {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      flex-direction: column;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      display: none;
      gap: 8px;
    }

    .blog-nav.active {
      display: flex;
    }

    .blog-nav a {
      width: 100%;
      text-align: center;
      padding: 12px;
    }

    .mobile-menu-btn {
      display: flex;
    }

    .header-actions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      flex-direction: column;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      display: none;
      margin-top: 1px;
    }

    .header-actions.active {
      display: flex;
    }

    .user-menu {
      width: 100%;
      justify-content: center;
    }

    .header-btn {
      width: 100%;
      text-align: center;
    }
  }

  @media (max-width: 640px) {
    .blog-header .header-container {
      padding: 12px 16px;
    }

    .blog-brand-text {
      display: none;
    }
  }
</style>

<header class="blog-header">
  <div class="header-container">
    <!-- Brand -->
    <a href="/" class="blog-brand">
      <div class="blog-logo">B</div>
      <span class="blog-brand-text">BlogHub</span>
    </a>

    <!-- Navigation -->
    <nav class="blog-nav" id="blogNav">
      <a href="/" class="<%= typeof currentPage !== 'undefined' && currentPage === 'home' ? 'active' : '' %>">Home</a>
      <% if (session.user) { %>
        <% if (session.user.role === 'admin') { %>
          <a href="/admin" class="<%= typeof currentPage !== 'undefined' && currentPage === 'admin' ? 'active' : '' %>">Dashboard</a>
        <% } else if (session.user.role === 'author') { %>
          <a href="/author" class="<%= typeof currentPage !== 'undefined' && currentPage === 'author' ? 'active' : '' %>">My Posts</a>
        <% } else { %>
          <a href="/user" class="<%= typeof currentPage !== 'undefined' && currentPage === 'user' ? 'active' : '' %>">Explore</a>
        <% } %>
      <% } %>
      <a href="/#featured">Featured</a>
      <a href="/#categories">Categories</a>
    </nav>

    <!-- Actions -->
    <div class="header-actions" id="headerActions">
      <% if (session.user) { %>
        <div class="user-menu">
          <div class="user-avatar"><%= session.user.name.charAt(0).toUpperCase() %></div>
          <span class="user-name"><%= session.user.name %></span>
        </div>
        <a href="/logout" class="header-btn btn-logout">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a>
      <% } else { %>
        <a href="/login" class="header-btn btn-login">Login</a>
        <a href="/signup" class="header-btn btn-signup">Get Started</a>
      <% } %>
    </div>

    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const blogNav = document.getElementById('blogNav');
  const headerActions = document.getElementById('headerActions');

  if (mobileMenuBtn) {
    mobileMenuBtn.addEventListener('click', () => {
      mobileMenuBtn.classList.toggle('active');
      blogNav.classList.toggle('active');
      headerActions.classList.toggle('active');
    });
  }

  // Close mobile menu when clicking outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.blog-header')) {
      mobileMenuBtn?.classList.remove('active');
      blogNav?.classList.remove('active');
      headerActions?.classList.remove('active');
    }
  });
</script>

<div class="content-wrapper">
  <aside class="sidebar position-fixed top-0 left-0 overflow-auto h-100 float-left" id="show-side-navigation1">
    <div class="sidebar-header d-flex justify-content-center align-items-center px-3 py-4">
      <div class="ms-2">
        <h5 class="fs-6 mb-0">
          <a class="text-decoration-none" href="#"><%= session.user.name %></a>
        </h5>
        <p class="mt-1 mb-0">Author Dashboard</p>
      </div>
    </div>
    <hr>
    <br>
    <ul class="categories list-unstyled">
      <li>
       <a href="/author" class="active"><i class="uil-estate fa-fw"></i> Dashboard</a>
      </li>
      <li>
        <a href="/author/create"><i class="uil-plus-circle"></i> Create Post</a>
      </li>
      <li>
        <a href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
      </li>
    </ul>
  </aside>

  <div class="main-content">
    <div class="welcome">
      <h1>Author Dashboard</h1>
      <p>Welcome back, <%= session.user.name %>! Manage your blog posts here.</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <h3>Total Posts</h3>
        <div class="number"><%= stats.total_posts %></div>
      </div>
      <div class="stat-card">
        <h3>Published</h3>
        <div class="number"><%= stats.published %></div>
      </div>
      <div class="stat-card">
        <h3>Drafts</h3>
        <div class="number"><%= stats.drafts %></div>
      </div>
      <div class="stat-card">
        <h3>Total Likes</h3>
        <div class="number"><%= stats.total_likes %></div>
      </div>
      <div class="stat-card">
        <h3>Total Comments</h3>
        <div class="number"><%= stats.total_comments %></div>
      </div>
    </div>

    <a href="/author/create" class="create-btn">
      <i class="fas fa-plus"></i> Create New Post
    </a>

    <div class="blogs-table">
      <table>
        <thead>
          <tr>
            <th>Title</th>
            <th>Category</th>
            <th>Status</th>
            <th>Likes</th>
            <th>Comments</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% if (blogs.length === 0) { %>
            <tr>
              <td colspan="7" style="text-align: center; padding: 2rem; color: #7f8c8d;">
                No posts yet. Create your first blog post!
              </td>
            </tr>
          <% } else { %>
            <% blogs.forEach(blog => { %>
              <tr>
                <td><strong><%= blog.title %></strong></td>
                <td><%= blog.category %></td>
                <td>
                  <span class="status-badge <%= blog.status === 'published' ? 'status-published' : 'status-draft' %>">
                    <%= blog.status %>
                  </span>
                </td>
                <td>‚ù§Ô∏è <%= blog.like_count %></td>
                <td>üí¨ <%= blog.comment_count %></td>
                <td><%= new Date(blog.created_at).toLocaleDateString() %></td>
                <td>
                  <div class="action-btns">
                    <a href="/blog/<%= blog.slug %>" class="btn-sm btn-view" target="_blank">View</a>
                    <a href="/author/edit/<%= blog.id %>" class="btn-sm btn-edit">Edit</a>
                    <form method="POST" action="/author/delete/<%= blog.id %>" style="display: inline;" onsubmit="return confirm('Delete this post?')">
                      <button type="submit" class="btn-sm btn-delete">Delete</button>
                    </form>
                  </div>
                </td>
              </tr>
            <% }); %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script src="/js/header.js"></script>